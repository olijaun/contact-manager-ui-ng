<div class="primary-header">
  <h1>Memberships</h1>
</div>
<div class="container" fxLayout="column" fxLayoutGap="10pt">

  <app-messages></app-messages>

    <div>
      <mat-card>
        <!--<mat-card-title>Person</mat-card-title>-->
        <mat-card-content>{{ member.firstName }} {{ member.lastNameOrCompanyName }},
          {{ member.address }}
        </mat-card-content>
        <mat-card-actions>
          <button mat-button (click)="editPersonClicked()">Edit Person</button>
        </mat-card-actions>
      </mat-card>
    </div>
    <!--<form (ngSubmit)="save(membershipForm.value)" [formGroup]="membershipForm">-->
    <form>
      <div>
        <mat-card>
          <mat-card-title>Memberships</mat-card-title>
          <mat-card-content>

            <div fxLayout="row wrap" fxLayoutGap="10pt">

              <mat-form-field appearance="standard" fxFill>
                <mat-label>Subscription Period</mat-label>
                <mat-select name="subscriptionPeriod" [(ngModel)]="selectedPeriod">
                  <mat-option *ngFor="let subscriptionPeriod of subscriptionPeriods" [value]="subscriptionPeriod">
                    {{ subscriptionPeriod.name }}
                  </mat-option>
                </mat-select>
              </mat-form-field>

              <mat-form-field appearance="standard" fxFill>
                <mat-label>Subscription Type</mat-label>
                <mat-select name="subscriptionType" [(ngModel)]="selectedSubscriptionType">
                  <mat-option *ngFor="let subscriptionType of selectedPeriod.subscriptionTypes" [value]="subscriptionType">
                    {{ subscriptionType.name }}
                  </mat-option>
                </mat-select>
              </mat-form-field>

              <button mat-raised-button (click)="addSubscription()">add</button>
            </div>

          </mat-card-content>

          <div fxLayout="column" fxLayoutGap="10pt">
            <table mat-table [dataSource]="member.subscriptions" class="mat-elevation-z8">

              <ng-container matColumnDef="id">
                <th mat-header-cell *matHeaderCellDef>Id</th>
                <td mat-cell *matCellDef="let element">{{element.id}}</td>
              </ng-container>

              <ng-container matColumnDef="subscriptionPeriodId">
                <th mat-header-cell *matHeaderCellDef>Subscription Period</th>
                <td mat-cell *matCellDef="let element">{{ subscriptionPeriodNameById(element.subscriptionPeriodId) }}</td>
              </ng-container>

              <ng-container matColumnDef="subscriptionTypeId">
                <th mat-header-cell *matHeaderCellDef>Subscription Type</th>
                <td mat-cell *matCellDef="let element">{{ subscriptionTypeNameById(element) }}</td>
              </ng-container>

              <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
              <tr mat-row *matRowDef="let row; columns: displayedColumns;" (click)="rowClicked(row)"></tr>
            </table>
            <button class="submit-btn" color="primary" mat-raised-button type="submit" (click)="save()">Save
              Memberships
            </button>
          </div>
        </mat-card>
      </div>
    </form>
</div>
