<div class="container">

  <h2 *ngIf="this.isNew()">New Person</h2>
  <h2 *ngIf="!this.isNew()">{{ personDetailForm.get('lastNameOrCompanyName').value | uppercase }}, {{
    personDetailForm.get('firstName').value |
    uppercase
    }}</h2>
  <form (ngSubmit)="save(personDetailForm.value)" [formGroup]="personDetailForm">

    <label class="label">
      <app-messages></app-messages>
    </label>


    <mat-tab-group fxLayout="column">

      <mat-tab label="Basic Data">

        <mat-card>

          <mat-card-content fxLayout="column">
            <mat-form-field appearance="outline" class="component" gdArea="id">
              <mat-label>Id</mat-label>
              <input name="id" matInput placeholder="Id" formControlName="id" readonly>
            </mat-form-field>

            <mat-form-field appearance="outline" gdArea="type">
              <mat-label>Type</mat-label>
              <mat-select name="personType" [disabled]="!this.isNew()" formControlName="type">
                <mat-option *ngFor="let personType of types" [value]="personType">
                  {{ personType.viewValue }}
                </mat-option>
              </mat-select>
            </mat-form-field>

            <div fxLayout="row wrap">
              <mat-form-field appearance="outline" *ngIf="isPerson()" class="component" gdArea="firstName">
                <mat-label>First name</mat-label>
                <input name="firstName" matInput placeholder="First Name" formControlName="firstName">
                <mat-error *ngFor="let validation of validation_messages.firstName">
                  <mat-error class="error-message"
                             *ngIf="personDetailForm.get('firstName').hasError(validation.type) && (personDetailForm.get('firstName').dirty || personDetailForm.get('firstName').touched)">
                    {{validation.message}}
                  </mat-error>
                </mat-error>
              </mat-form-field>

              <mat-form-field appearance="outline" gdArea="lastName">
                <mat-label>Last name</mat-label>
                <input name="lastNameOrCompanyName" matInput placeholder="Last Name" formControlName="lastNameOrCompanyName">
                <mat-error *ngFor="let validation of validation_messages.lastName">
                  <mat-error class="error-message"
                             *ngIf="personDetailForm.get('lastNameOrCompanyName').hasError(validation.type) && (personDetailForm.get('lastNameOrCompanyName').dirty || personDetailForm.get('lastNameOrCompanyName').touched)">
                    {{validation.message}}
                  </mat-error>
                </mat-error>
              </mat-form-field>
            </div>

            <mat-form-field *ngIf="isPerson()" appearance="outline" gdArea="birthDate">

              <input matInput [matDatepicker]="dp" placeholder="Birth date" formControlName="birthDate">
              <mat-datepicker-toggle matSuffix [for]="dp"></mat-datepicker-toggle>
              <mat-datepicker #dp></mat-datepicker>
              <mat-error *ngFor="let validation of validation_messages.birthDate">
                <mat-error class="error-message"
                           *ngIf="personDetailForm.get('birthDate').hasError(validation.type) && (personDetailForm.get('birthDate').dirty || personDetailForm.get('birthDate').touched)">
                  {{validation.message}}
                </mat-error>
              </mat-error>

            </mat-form-field>

            <mat-form-field *ngIf="isPerson()" appearance="outline" gdArea="sex">
              <mat-select placeholder="Sex" formControlName="sex">
                <mat-option *ngFor="let sex of sexes" [value]="sex">
                  {{ sex.viewValue }}
                </mat-option>
              </mat-select>
              <mat-error *ngFor="let validation of validation_messages.sex">
                <mat-error class="error-message"
                           *ngIf="personDetailForm.get('sex').hasError(validation.type) && (personDetailForm.get('sex').dirty || personDetailForm.get('sex').touched)">
                  {{validation.message}}
                </mat-error>
              </mat-error>
            </mat-form-field>
          </mat-card-content>
        </mat-card>
      </mat-tab>

      <mat-tab label="Street Address" fxLayout="column" formGroupName="address">

        <mat-card>
          <mat-card-content fxLayout="column">
            <div>
              <mat-form-field appearance="standard">
                <mat-label>Street</mat-label>
                <input matInput placeholder="" formControlName="street">
              </mat-form-field>
              <mat-form-field appearance="standard">
                <mat-label>Number</mat-label>
                <input matInput placeholder="" formControlName="streetNumber">
              </mat-form-field>
            </div>
            <div>
              <mat-form-field appearance="standard">
                <mat-label>Zip</mat-label>
                <input matInput placeholder="" formControlName="zip">
              </mat-form-field>
              <mat-form-field appearance="standard">
                <mat-label>City</mat-label>
                <input matInput placeholder="" formControlName="city">
              </mat-form-field>
              <mat-form-field class="example-full-width">
                <input type="text"
                       placeholder="Country"
                       aria-label="Country"
                       matInput
                       formControlName="isoCountryCode"
                       [matAutocomplete]="auto">

                <mat-autocomplete #auto="matAutocomplete" [displayWith]="displayFn">
                  <mat-option *ngFor="let country of filteredOptions | async" [value]="country">
                    {{country.Name}}
                  </mat-option>
                </mat-autocomplete>
              </mat-form-field>

            </div>
          </mat-card-content>
        </mat-card>
      </mat-tab>

      <mat-tab label="Contact Info" fxLayout="column">

        <mat-card>
          <mat-card-content fxLayout="column">
            <mat-form-field appearance="outline">
              <mat-label>E-Mail Address</mat-label>
              <input name="emailAddress" matInput placeholder="me@mail.com" formControlName="emailAddress">
            </mat-form-field>
            <mat-form-field appearance="outline">
              <mat-label>Phone Number</mat-label>
              <input name="phoneNumber" matInput placeholder="" formControlName="phoneNumber">
            </mat-form-field>
          </mat-card-content>
        </mat-card>
      </mat-tab>

    </mat-tab-group>
    <button class="submit-btn" color="primary" mat-raised-button type="submit" [disabled]="!personDetailForm.valid">Submit
    </button>

  </form>

</div>
